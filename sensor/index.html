



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.2.0">
    
    
      
        <title>Sensor - Argo Events - The Event-Based Dependency Manager for Kubernetes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.750b69bd.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,400i,700|">
        <style>body,input{font-family:"Work Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-105170809-2", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#sensor" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Argo Events - The Event-Based Dependency Manager for Kubernetes" class="md-header-nav__button md-logo">
          
            <img src="../assets/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Argo Events - The Event-Based Dependency Manager for Kubernetes
            </span>
            <span class="md-header-nav__topic">
              Sensor
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/argoproj/argo-events/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Argo Events - The Event-Based Dependency Manager for Kubernetes" class="md-nav__button md-logo">
      
        <img src="../assets/logo.png" width="48" height="48">
      
    </a>
    Argo Events - The Event-Based Dependency Manager for Kubernetes
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/argoproj/argo-events/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../getting_started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Setup
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Setup
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/artifact/" title="Minio S3" class="md-nav__link">
      Minio S3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/aws-sns/" title="AWS SNS" class="md-nav__link">
      AWS SNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/aws-sqs/" title="AWS SQS" class="md-nav__link">
      AWS SQS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/calendar/" title="Calendar" class="md-nav__link">
      Calendar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/file/" title="File" class="md-nav__link">
      File
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/gcp-pubsub/" title="GCP PubSub" class="md-nav__link">
      GCP PubSub
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/github/" title="Github" class="md-nav__link">
      Github
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/gitlab/" title="Gitlab" class="md-nav__link">
      Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/resource/" title="Resource" class="md-nav__link">
      Resource
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/slack/" title="Slack" class="md-nav__link">
      Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/storage-grid/" title="StorageGrid" class="md-nav__link">
      StorageGrid
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/streams/" title="Streams" class="md-nav__link">
      Streams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gateways/webhook/" title="Webhook" class="md-nav__link">
      Webhook
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../gateway/" title="Gateway" class="md-nav__link">
      Gateway
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Sensor
      </label>
    
    <a href="./" title="Sensor" class="md-nav__link md-nav__link--active">
      Sensor
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-an-event-dependency" title="What is an event dependency?" class="md-nav__link">
    What is an event dependency?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-dependency-group" title="What is a dependency group?" class="md-nav__link">
    What is a dependency group?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-circuit" title="What is a circuit?" class="md-nav__link">
    What is a circuit?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-trigger" title="What is a trigger?" class="md-nav__link">
    What is a trigger?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-works" title="How it works?" class="md-nav__link">
    How it works?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-example" title="Basic Example" class="md-nav__link">
    Basic Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#circuit" title="Circuit" class="md-nav__link">
    Circuit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#execution-and-backoff-policy" title="Execution and Backoff Policy" class="md-nav__link">
    Execution and Backoff Policy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filters" title="Filters" class="md-nav__link">
    Filters
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#time-filter" title="Time Filter" class="md-nav__link">
    Time Filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventcontext-filter" title="EventContext Filter" class="md-nav__link">
    EventContext Filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-filter" title="Data filter" class="md-nav__link">
    Data filter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" title="Examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../trigger/" title="Trigger" class="md-nav__link">
      Trigger
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../parameterization/" title="Trigger Parameterization" class="md-nav__link">
      Trigger Parameterization
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../communication/" title="Persisting Events" class="md-nav__link">
      Persisting Events
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../controllers/" title="Controllers" class="md-nav__link">
      Controllers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://github.com/argoproj/argo-events/releases" title="Releases ⧉" class="md-nav__link">
      Releases ⧉
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://github.com/argoproj/argo-events/milestones" title="Roadmap ⧉" class="md-nav__link">
      Roadmap ⧉
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://blog.argoproj.io/" title="Blog ⧉" class="md-nav__link">
      Blog ⧉
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-an-event-dependency" title="What is an event dependency?" class="md-nav__link">
    What is an event dependency?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-dependency-group" title="What is a dependency group?" class="md-nav__link">
    What is a dependency group?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-circuit" title="What is a circuit?" class="md-nav__link">
    What is a circuit?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-trigger" title="What is a trigger?" class="md-nav__link">
    What is a trigger?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-works" title="How it works?" class="md-nav__link">
    How it works?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-example" title="Basic Example" class="md-nav__link">
    Basic Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#circuit" title="Circuit" class="md-nav__link">
    Circuit
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#execution-and-backoff-policy" title="Execution and Backoff Policy" class="md-nav__link">
    Execution and Backoff Policy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filters" title="Filters" class="md-nav__link">
    Filters
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#time-filter" title="Time Filter" class="md-nav__link">
    Time Filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventcontext-filter" title="EventContext Filter" class="md-nav__link">
    EventContext Filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-filter" title="Data filter" class="md-nav__link">
    Data filter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" title="Examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/argoproj/argo-events/edit/master/docs/sensor.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="sensor">Sensor<a class="headerlink" href="#sensor" title="Permanent link">&para;</a></h1>
<p>Sensors define a set of event dependencies (inputs) and triggers (outputs). 
<br/></p>
<p align="center">
  <img src="https://github.com/argoproj/argo-events/blob/master/docs/assets/sensor.png?raw=true" alt="Sensor"/>
</p>

<p><br/></p>
<h2 id="what-is-an-event-dependency">What is an event dependency?<a class="headerlink" href="#what-is-an-event-dependency" title="Permanent link">&para;</a></h2>
<p>A dependency is an event the sensor is waiting to happen. It is defined as "gateway-name:event-source-name".</p>
<h2 id="what-is-a-dependency-group">What is a dependency group?<a class="headerlink" href="#what-is-a-dependency-group" title="Permanent link">&para;</a></h2>
<p>A dependency group is basically a group of event dependencies.</p>
<h2 id="what-is-a-circuit">What is a circuit?<a class="headerlink" href="#what-is-a-circuit" title="Permanent link">&para;</a></h2>
<p>Circuit is any arbitrary boolean logic that can be applied on dependency groups.</p>
<h2 id="what-is-a-trigger">What is a trigger?<a class="headerlink" href="#what-is-a-trigger" title="Permanent link">&para;</a></h2>
<p>Refer <a href="../trigger/">Triggers</a>.</p>
<h2 id="how-it-works">How it works?<a class="headerlink" href="#how-it-works" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Once the sensor receives an event from gateway either over HTTP or through NATS, it validates
  the event against dependencies defined in sensor spec. If the event is expected, then it is marked as a valid
  event and the dependency is marked as resolved.</p>
</li>
<li>
<p>If you haven't defined dependency groups, sensor basically waits for all dependencies to resolve
  and then kicks off triggers in sequence. If filters are defined, sensor applies the filter on target event 
  and if events pass the filters, triggers are fired.</p>
</li>
<li>
<p>If you have defined dependency groups, sensor upon receiving an event evaluates the group to which the event belongs to
  and marks the group as resolved if all other event dependencies in the group are already resolved.</p>
</li>
<li>
<p>Whenever a dependency group is resolved, sensor evaluates the <code>circuit</code> defined in spec. If the <code>circuit</code> resolves to true, the
  triggers are fired. Sensor always waits for <code>circuit</code> to resolve to true before firing triggers.</p>
</li>
<li>
<p>You may not want to fire all the triggers defined in sensor spec. For that, sensor offers <code>when</code> switch on triggers. Basically <code>when</code> switch is way to control when to fire certain trigger depending upon which dependency group is resolved. </p>
</li>
<li>
<p>After sensor fires triggers, it transitions into <code>complete</code> state, increments completion counter and initializes it's state back to running and start the process all over again. Any event that is received in-between are stored on the internal queue.</p>
</li>
</ol>
<p><strong>Note</strong>: If you don't provide dependency groups and <code>circuit</code>, sensor performs an <code>AND</code> operation on event dependencies.</p>
<h2 id="basic-example">Basic Example<a class="headerlink" href="#basic-example" title="Permanent link">&para;</a></h2>
<p>Lets look at a basic example,</p>
<div class="codehilite"><pre><span></span><span class="n">apiVersion</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Sensor</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">webhook</span><span class="o">-</span><span class="n">sensor</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">sensors</span><span class="o">.</span><span class="na">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">sensor</span><span class="o">-</span><span class="n">controller</span><span class="o">-</span><span class="n">instanceid</span><span class="o">:</span> <span class="n">argo</span><span class="o">-</span><span class="n">events</span>
    <span class="err">#</span> <span class="n">sensor</span> <span class="n">controller</span> <span class="n">will</span> <span class="n">use</span> <span class="k">this</span> <span class="n">label</span> <span class="n">to</span> <span class="n">match</span> <span class="k">with</span> <span class="n">it</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">own</span> <span class="n">version</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">not</span> <span class="n">remove</span>
    <span class="n">argo</span><span class="o">-</span><span class="n">events</span><span class="o">-</span><span class="n">sensor</span><span class="o">-</span><span class="n">version</span><span class="o">:</span> <span class="n">v0</span><span class="o">.</span><span class="mi">10</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">template</span><span class="o">:</span>
    <span class="n">spec</span><span class="o">:</span>
      <span class="n">containers</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;sensor&quot;</span>
          <span class="n">image</span><span class="o">:</span> <span class="s2">&quot;argoproj/sensor&quot;</span>
          <span class="n">imagePullPolicy</span><span class="o">:</span> <span class="n">Always</span>
      <span class="n">serviceAccountName</span><span class="o">:</span> <span class="n">argo</span><span class="o">-</span><span class="n">events</span><span class="o">-</span><span class="n">sa</span>
  <span class="n">dependencies</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway:example&quot;</span>
  <span class="n">eventProtocol</span><span class="o">:</span>
    <span class="n">type</span><span class="o">:</span> <span class="s2">&quot;HTTP&quot;</span>
    <span class="n">http</span><span class="o">:</span>
      <span class="n">port</span><span class="o">:</span> <span class="s2">&quot;9300&quot;</span>
  <span class="n">triggers</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">template</span><span class="o">:</span>
        <span class="n">name</span><span class="o">:</span> <span class="n">webhook</span><span class="o">-</span><span class="n">workflow</span><span class="o">-</span><span class="n">trigger</span>
        <span class="n">group</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span>
        <span class="n">version</span><span class="o">:</span> <span class="n">v1alpha1</span>
        <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
        <span class="n">source</span><span class="o">:</span>
          <span class="n">inline</span><span class="o">:</span> <span class="o">|</span>
            <span class="n">apiVersion</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
            <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
            <span class="n">metadata</span><span class="o">:</span>
              <span class="n">generateName</span><span class="o">:</span> <span class="n">webhook</span><span class="o">-</span>
            <span class="n">spec</span><span class="o">:</span>
              <span class="n">entrypoint</span><span class="o">:</span> <span class="n">whalesay</span>
              <span class="k">arguments</span><span class="o">:</span>
                <span class="n">parameters</span><span class="o">:</span>
                <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">message</span>
                  <span class="err">#</span> <span class="k">this</span> <span class="k">is</span> <span class="n">the</span> <span class="n">value</span> <span class="n">that</span> <span class="n">should</span> <span class="n">be</span> <span class="n">overridden</span>
                  <span class="n">value</span><span class="o">:</span> <span class="n">hello</span> <span class="n">world</span>
              <span class="n">templates</span><span class="o">:</span>
              <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">whalesay</span>
                <span class="n">inputs</span><span class="o">:</span>
                  <span class="n">parameters</span><span class="o">:</span>
                  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">message</span>
                <span class="n">container</span><span class="o">:</span>
                  <span class="n">image</span><span class="o">:</span> <span class="n">docker</span><span class="o">/</span><span class="n">whalesay</span><span class="o">:</span><span class="n">latest</span>
                  <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="n">cowsay</span><span class="o">]</span>
                  <span class="n">args</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;{{inputs.parameters.message}}&quot;</span><span class="o">]</span>
      <span class="n">resourceParameters</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">src</span><span class="o">:</span>
            <span class="n">event</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway:example&quot;</span>
          <span class="n">dest</span><span class="o">:</span> <span class="n">spec</span><span class="o">.</span><span class="na">arguments</span><span class="o">.</span><span class="na">parameters</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="na">value</span>
</pre></div>


<p>i. The <code>spec.template.spec</code> defines the template for the sensor pod.</p>
<p>ii. The <code>dependencies</code> define list of events the sensor is expected to receive, meaning this is an AND operation.</p>
<p>iii. <code>eventProtocol</code> express the mode of communication to receive events
from gateways. </p>
<p>iv. <code>triggers</code> define list of templates, each containing specification for a K8s resource and optional parameters. </p>
<h2 id="circuit">Circuit<a class="headerlink" href="#circuit" title="Permanent link">&para;</a></h2>
<p>Now, lets look at a more complex example involving a circuit,</p>
<div class="codehilite"><pre><span></span><span class="n">apiVersion</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Sensor</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">webhook</span><span class="o">-</span><span class="n">sensor</span><span class="o">-</span><span class="n">http</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">sensors</span><span class="o">.</span><span class="na">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">sensor</span><span class="o">-</span><span class="n">controller</span><span class="o">-</span><span class="n">instanceid</span><span class="o">:</span> <span class="n">argo</span><span class="o">-</span><span class="n">events</span>
    <span class="err">#</span> <span class="n">sensor</span> <span class="n">controller</span> <span class="n">will</span> <span class="n">use</span> <span class="k">this</span> <span class="n">label</span> <span class="n">to</span> <span class="n">match</span> <span class="k">with</span> <span class="n">it</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">own</span> <span class="n">version</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">not</span> <span class="n">remove</span>
    <span class="n">argo</span><span class="o">-</span><span class="n">events</span><span class="o">-</span><span class="n">sensor</span><span class="o">-</span><span class="n">version</span><span class="o">:</span> <span class="n">v0</span><span class="o">.</span><span class="mi">10</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">template</span><span class="o">:</span>
    <span class="n">spec</span><span class="o">:</span>
      <span class="n">containers</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;sensor&quot;</span>
          <span class="n">image</span><span class="o">:</span> <span class="s2">&quot;argoproj/sensor&quot;</span>
          <span class="n">imagePullPolicy</span><span class="o">:</span> <span class="n">Always</span>
      <span class="n">serviceAccountName</span><span class="o">:</span> <span class="n">argo</span><span class="o">-</span><span class="n">events</span><span class="o">-</span><span class="n">sa</span>
  <span class="n">dependencies</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint1&quot;</span>
      <span class="n">filters</span><span class="o">:</span>
        <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;context-filter&quot;</span>
        <span class="n">context</span><span class="o">:</span>
          <span class="n">source</span><span class="o">:</span>
            <span class="n">host</span><span class="o">:</span> <span class="n">xyz</span><span class="o">.</span><span class="na">com</span>
          <span class="n">contentType</span><span class="o">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint2&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint3&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint4&quot;</span>
      <span class="n">filters</span><span class="o">:</span>
        <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;data-filter&quot;</span>
        <span class="n">data</span><span class="o">:</span>
          <span class="o">-</span> <span class="n">path</span><span class="o">:</span> <span class="n">bucket</span>
            <span class="n">type</span><span class="o">:</span> <span class="n">string</span>
            <span class="n">value</span><span class="o">:</span>
              <span class="o">-</span> <span class="s2">&quot;argo-workflow-input&quot;</span>
              <span class="o">-</span> <span class="s2">&quot;argo-workflow-input1&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint5&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint6&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint7&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint8&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint9&quot;</span>
  <span class="n">dependencyGroups</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;group_1&quot;</span>
      <span class="n">dependencies</span><span class="o">:</span>
        <span class="o">-</span> <span class="s2">&quot;webhook-gateway-http:endpoint1&quot;</span>
        <span class="o">-</span> <span class="s2">&quot;webhook-gateway-http:endpoint2&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;group_2&quot;</span>
      <span class="n">dependencies</span><span class="o">:</span>
        <span class="o">-</span> <span class="s2">&quot;webhook-gateway-http:endpoint3&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;group_3&quot;</span>
      <span class="n">dependencies</span><span class="o">:</span>
        <span class="o">-</span> <span class="s2">&quot;webhook-gateway-http:endpoint4&quot;</span>
        <span class="o">-</span> <span class="s2">&quot;webhook-gateway-http:endpoint5&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;group_4&quot;</span>
      <span class="n">dependencies</span><span class="o">:</span>
        <span class="o">-</span> <span class="s2">&quot;webhook-gateway-http:endpoint6&quot;</span>
        <span class="o">-</span> <span class="s2">&quot;webhook-gateway-http:endpoint7&quot;</span>
        <span class="o">-</span> <span class="s2">&quot;webhook-gateway-http:endpoint8&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="s2">&quot;group_5&quot;</span>
      <span class="n">dependencies</span><span class="o">:</span>
        <span class="o">-</span> <span class="s2">&quot;webhook-gateway-http:endpoint9&quot;</span>
  <span class="n">circuit</span><span class="o">:</span> <span class="s2">&quot;group_1 || group_2 || ((group_3 || group_4) &amp;&amp; group_5)&quot;</span>
  <span class="n">eventProtocol</span><span class="o">:</span>
    <span class="n">type</span><span class="o">:</span> <span class="s2">&quot;HTTP&quot;</span>
    <span class="n">http</span><span class="o">:</span>
      <span class="n">port</span><span class="o">:</span> <span class="s2">&quot;9300&quot;</span>
  <span class="n">triggers</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">template</span><span class="o">:</span>
        <span class="n">when</span><span class="o">:</span>
          <span class="n">any</span><span class="o">:</span>
            <span class="o">-</span> <span class="s2">&quot;group_1&quot;</span>
            <span class="o">-</span> <span class="s2">&quot;group_2&quot;</span>
        <span class="n">name</span><span class="o">:</span> <span class="n">webhook</span><span class="o">-</span><span class="n">workflow</span><span class="o">-</span><span class="n">trigger</span>
        <span class="n">group</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span>
        <span class="n">version</span><span class="o">:</span> <span class="n">v1alpha1</span>
        <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
        <span class="n">source</span><span class="o">:</span>
          <span class="n">inline</span><span class="o">:</span> <span class="o">|</span>
            <span class="n">apiVersion</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
            <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
            <span class="n">metadata</span><span class="o">:</span>
              <span class="n">generateName</span><span class="o">:</span> <span class="n">hello</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span>
            <span class="n">spec</span><span class="o">:</span>
              <span class="n">entrypoint</span><span class="o">:</span> <span class="n">whalesay</span>
              <span class="k">arguments</span><span class="o">:</span>
                <span class="n">parameters</span><span class="o">:</span>
                <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">message</span>
                  <span class="err">#</span> <span class="k">this</span> <span class="k">is</span> <span class="n">the</span> <span class="n">value</span> <span class="n">that</span> <span class="n">should</span> <span class="n">be</span> <span class="n">overridden</span>
                  <span class="n">value</span><span class="o">:</span> <span class="n">hello</span> <span class="n">world</span>
              <span class="n">templates</span><span class="o">:</span>
              <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">whalesay</span>
                <span class="n">inputs</span><span class="o">:</span>
                  <span class="n">parameters</span><span class="o">:</span>
                  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">message</span>
                <span class="n">container</span><span class="o">:</span>
                  <span class="n">image</span><span class="o">:</span> <span class="n">docker</span><span class="o">/</span><span class="n">whalesay</span><span class="o">:</span><span class="n">latest</span>
                  <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="n">cowsay</span><span class="o">]</span>
                  <span class="n">args</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;{{inputs.parameters.message}}&quot;</span><span class="o">]</span>
      <span class="n">resourceParameters</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">src</span><span class="o">:</span>
            <span class="n">event</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:endpoint1&quot;</span>
          <span class="n">dest</span><span class="o">:</span> <span class="n">spec</span><span class="o">.</span><span class="na">arguments</span><span class="o">.</span><span class="na">parameters</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="na">value</span>
    <span class="o">-</span> <span class="n">template</span><span class="o">:</span>
        <span class="n">name</span><span class="o">:</span> <span class="n">webhook</span><span class="o">-</span><span class="n">workflow</span><span class="o">-</span><span class="n">trigger</span><span class="o">-</span><span class="mi">2</span>
        <span class="n">when</span><span class="o">:</span>
          <span class="n">all</span><span class="o">:</span>
            <span class="o">-</span> <span class="s2">&quot;group_5&quot;</span>
            <span class="o">-</span> <span class="s2">&quot;group_4&quot;</span>
        <span class="n">group</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span>
        <span class="n">version</span><span class="o">:</span> <span class="n">v1alpha1</span>
        <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
        <span class="n">source</span><span class="o">:</span>
          <span class="n">inline</span><span class="o">:</span> <span class="o">|</span>
            <span class="n">apiVersion</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
            <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
            <span class="n">metadata</span><span class="o">:</span>
              <span class="n">generateName</span><span class="o">:</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span>
            <span class="n">spec</span><span class="o">:</span>
              <span class="n">entrypoint</span><span class="o">:</span> <span class="n">whalesay</span>
              <span class="n">templates</span><span class="o">:</span>
                <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">whalesay</span>
                  <span class="n">container</span><span class="o">:</span>
                    <span class="n">args</span><span class="o">:</span>
                      <span class="o">-</span> <span class="s2">&quot;hello world&quot;</span>
                    <span class="n">command</span><span class="o">:</span>
                      <span class="o">-</span> <span class="n">cowsay</span>
                    <span class="n">image</span><span class="o">:</span> <span class="s2">&quot;docker/whalesay:latest&quot;</span>
    <span class="o">-</span> <span class="n">template</span><span class="o">:</span>
        <span class="n">name</span><span class="o">:</span> <span class="n">webhook</span><span class="o">-</span><span class="n">workflow</span><span class="o">-</span><span class="n">trigger</span><span class="o">-</span><span class="n">common</span>
        <span class="n">group</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span>
        <span class="n">version</span><span class="o">:</span> <span class="n">v1alpha1</span>
        <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
        <span class="n">source</span><span class="o">:</span>
          <span class="n">inline</span><span class="o">:</span> <span class="o">|</span>
            <span class="n">apiVersion</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
            <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
            <span class="n">metadata</span><span class="o">:</span>
              <span class="n">generateName</span><span class="o">:</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">common</span><span class="o">-</span>
            <span class="n">spec</span><span class="o">:</span>
              <span class="n">entrypoint</span><span class="o">:</span> <span class="n">whalesay</span>
              <span class="n">templates</span><span class="o">:</span>
                <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">whalesay</span>
                  <span class="n">container</span><span class="o">:</span>
                    <span class="n">args</span><span class="o">:</span>
                      <span class="o">-</span> <span class="s2">&quot;hello world&quot;</span>
                    <span class="n">command</span><span class="o">:</span>
                      <span class="o">-</span> <span class="n">cowsay</span>
                    <span class="n">image</span><span class="o">:</span> <span class="s2">&quot;docker/whalesay:latest&quot;</span>
</pre></div>


<p>The sensor defines the list of dependencies with few containing filters. The filters are explained next. These dependencies are then grouped using <code>dependenciesGroups</code>. </p>
<p>The significance of <code>dependenciesGroups</code> is, if you don't define it, the sensor will apply an <code>AND</code> operation and wait for all events to occur. But you may not always want to wait for all the specified events to occur,
but rather trigger the workflows as soon as a group or groups of event dependencies are satisfied.</p>
<p>To define the logic of when to trigger the workflows, <code>circuit</code> contains a boolean expression that is evaluated every time a event dependency
is satisfied. Template can optionally contain <code>when</code> switch that determines when to trigger this template. </p>
<p>In the example, the first template will get triggered when either <code>group_1</code> or <code>group_2</code> dependencies groups are satisfied, the second template will get triggered only when both
<code>group_4</code> and <code>group_5</code> are triggered and the last template will be triggered every time the circuit evaluates to true.  </p>
<h2 id="execution-and-backoff-policy">Execution and Backoff Policy<a class="headerlink" href="#execution-and-backoff-policy" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">apiVersion</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Sensor</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">trigger</span><span class="o">-</span><span class="n">backoff</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">sensors</span><span class="o">.</span><span class="na">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">sensor</span><span class="o">-</span><span class="n">controller</span><span class="o">-</span><span class="n">instanceid</span><span class="o">:</span> <span class="n">argo</span><span class="o">-</span><span class="n">events</span>
    <span class="err">#</span> <span class="n">sensor</span> <span class="n">controller</span> <span class="n">will</span> <span class="n">use</span> <span class="k">this</span> <span class="n">label</span> <span class="n">to</span> <span class="n">match</span> <span class="k">with</span> <span class="n">it</span><span class="s1">&#39;s own version</span>
<span class="s1">    # do not remove</span>
<span class="s1">    argo-events-sensor-version: v0.10</span>
<span class="s1">spec:</span>
<span class="s1">  template:</span>
<span class="s1">    spec:</span>
<span class="s1">      containers:</span>
<span class="s1">        - name: &quot;sensor&quot;</span>
<span class="s1">          image: &quot;argoproj/sensor&quot;</span>
<span class="s1">          imagePullPolicy: Always</span>
<span class="s1">      serviceAccountName: argo-events-sa</span>
<span class="s1">  dependencies:</span>
<span class="s1">    - name: &quot;webhook-gateway-http:foo&quot;</span>
<span class="s1">  eventProtocol:</span>
<span class="s1">    type: &quot;HTTP&quot;</span>
<span class="s1">    http:</span>
<span class="s1">      port: &quot;9300&quot;</span>
<span class="s1">  # If set to true, marks sensor state as `error` if the previous trigger round fails.</span>
<span class="s1">  # Once sensor state is set to `error`, no further triggers will be processed.</span>
<span class="s1">  errorOnFailedRound: true</span>
<span class="s1">  triggers:</span>
<span class="s1">    - template:</span>
<span class="s1">        name: trigger-1</span>
<span class="s1">        # Policy to configure backoff and execution criteria for the trigger</span>
<span class="s1">        # Because the sensor is able to trigger any K8s resource, it determines the resource state by looking at the resource&#39;</span><span class="n">s</span> <span class="n">labels</span><span class="o">.</span>
        <span class="n">policy</span><span class="o">:</span>
          <span class="err">#</span> <span class="n">Backoff</span> <span class="n">before</span> <span class="n">checking</span> <span class="n">the</span> <span class="n">resource</span> <span class="n">labels</span>
          <span class="n">backoff</span><span class="o">:</span>
            <span class="err">#</span> <span class="n">Duration</span> <span class="k">is</span> <span class="n">the</span> <span class="n">duration</span> <span class="k">in</span> <span class="n">nanoseconds</span>
            <span class="n">duration</span><span class="o">:</span> <span class="mi">1000000000</span> <span class="err">#</span> <span class="mi">1</span> <span class="n">second</span>
            <span class="err">#</span> <span class="n">Duration</span> <span class="k">is</span> <span class="n">multiplied</span> <span class="n">by</span> <span class="n">factor</span> <span class="k">each</span> <span class="n">iteration</span>
            <span class="n">factor</span><span class="o">:</span> <span class="mi">2</span>
            <span class="err">#</span> <span class="n">The</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">jitter</span> <span class="n">applied</span> <span class="k">each</span> <span class="n">iteration</span>
            <span class="n">jitter</span><span class="o">:</span> <span class="mf">0.1</span>
            <span class="err">#</span> <span class="n">Exit</span> <span class="k">with</span> <span class="n">error</span> <span class="n">after</span> <span class="k">this</span> <span class="n">many</span> <span class="n">steps</span>
            <span class="n">steps</span><span class="o">:</span> <span class="mi">5</span>
          <span class="err">#</span> <span class="n">the</span> <span class="n">criteria</span> <span class="n">to</span> <span class="n">decide</span> <span class="k">if</span> <span class="n">a</span> <span class="n">resource</span> <span class="k">is</span> <span class="k">in</span> <span class="n">success</span> <span class="n">or</span> <span class="n">failure</span> <span class="n">state</span><span class="o">.</span>
          <span class="err">#</span> <span class="n">labels</span> <span class="kd">set</span> <span class="n">on</span> <span class="n">the</span> <span class="n">resource</span> <span class="n">decide</span> <span class="k">if</span> <span class="n">resource</span> <span class="k">is</span> <span class="k">in</span> <span class="n">success</span> <span class="n">or</span> <span class="n">failed</span> <span class="n">state</span><span class="o">.</span>
          <span class="n">state</span><span class="o">:</span>
            <span class="err">#</span> <span class="n">Note</span><span class="o">:</span> <span class="n">Set</span> <span class="n">either</span> <span class="n">success</span> <span class="n">or</span> <span class="n">failure</span> <span class="n">labels</span><span class="o">.</span> <span class="n">If</span> <span class="n">you</span> <span class="kd">set</span> <span class="n">both</span><span class="o">,</span> <span class="n">only</span> <span class="n">success</span> <span class="n">labels</span> <span class="n">will</span> <span class="n">be</span> <span class="n">considered</span><span class="o">.</span>

            <span class="err">#</span> <span class="n">Success</span> <span class="n">defines</span> <span class="n">labels</span> <span class="n">required</span> <span class="n">to</span> <span class="n">identify</span> <span class="n">a</span> <span class="n">resource</span> <span class="k">in</span> <span class="n">success</span> <span class="n">state</span>
            <span class="n">success</span><span class="o">:</span>
              <span class="n">workflows</span><span class="o">.</span><span class="na">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">phase</span><span class="o">:</span> <span class="n">Succeeded</span>
            <span class="err">#</span> <span class="n">Failure</span> <span class="n">defines</span> <span class="n">labels</span> <span class="n">required</span> <span class="n">to</span> <span class="n">identify</span> <span class="n">a</span> <span class="n">resource</span> <span class="k">in</span> <span class="n">failed</span> <span class="n">state</span>
            <span class="n">failure</span><span class="o">:</span>
              <span class="n">workflows</span><span class="o">.</span><span class="na">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">phase</span><span class="o">:</span> <span class="n">Failed</span>
          <span class="err">#</span> <span class="n">Determines</span> <span class="n">whether</span> <span class="n">trigger</span> <span class="n">should</span> <span class="n">be</span> <span class="n">marked</span> <span class="k">as</span> <span class="n">failed</span> <span class="k">if</span> <span class="n">the</span> <span class="n">backoff</span> <span class="n">times</span> <span class="n">out</span> <span class="n">and</span> <span class="n">sensor</span> <span class="k">is</span> <span class="n">still</span> <span class="n">unable</span> <span class="n">to</span> <span class="n">decide</span> <span class="n">the</span> <span class="n">state</span> <span class="n">of</span> <span class="n">the</span> <span class="n">trigger</span><span class="o">.</span>
          <span class="err">#</span> <span class="n">defaults</span> <span class="n">to</span> <span class="kc">false</span>
          <span class="n">errorOnBackoffTimeout</span><span class="o">:</span> <span class="kc">true</span>
        <span class="n">group</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span>
        <span class="n">version</span><span class="o">:</span> <span class="n">v1alpha1</span>
        <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
        <span class="n">source</span><span class="o">:</span>
          <span class="n">inline</span><span class="o">:</span> <span class="o">|</span>
            <span class="n">apiVersion</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
            <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
            <span class="n">metadata</span><span class="o">:</span>
              <span class="n">generateName</span><span class="o">:</span> <span class="n">webhook</span><span class="o">-</span>
            <span class="n">spec</span><span class="o">:</span>
              <span class="n">entrypoint</span><span class="o">:</span> <span class="n">whalesay</span>
              <span class="k">arguments</span><span class="o">:</span>
                <span class="n">parameters</span><span class="o">:</span>
                <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">message</span>
                  <span class="err">#</span> <span class="k">this</span> <span class="k">is</span> <span class="n">the</span> <span class="n">value</span> <span class="n">that</span> <span class="n">should</span> <span class="n">be</span> <span class="n">overridden</span>
                  <span class="n">value</span><span class="o">:</span> <span class="n">hello</span> <span class="n">world</span>
              <span class="n">templates</span><span class="o">:</span>
              <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">whalesay</span>
                <span class="n">inputs</span><span class="o">:</span>
                  <span class="n">parameters</span><span class="o">:</span>
                  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">message</span>
                <span class="n">container</span><span class="o">:</span>
                  <span class="n">image</span><span class="o">:</span> <span class="n">docker</span><span class="o">/</span><span class="n">whalesay</span><span class="o">:</span><span class="n">latest</span>
                  <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="n">cowsay</span><span class="o">]</span>
                  <span class="n">args</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;{{inputs.parameters.message}}&quot;</span><span class="o">]</span>
      <span class="n">resourceParameters</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">src</span><span class="o">:</span>
            <span class="n">event</span><span class="o">:</span> <span class="s2">&quot;webhook-gateway-http:foo&quot;</span>
          <span class="n">dest</span><span class="o">:</span> <span class="n">spec</span><span class="o">.</span><span class="na">arguments</span><span class="o">.</span><span class="na">parameters</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="na">value</span>
    <span class="o">-</span> <span class="n">template</span><span class="o">:</span>
        <span class="n">name</span><span class="o">:</span> <span class="n">trigger</span><span class="o">-</span><span class="mi">2</span>
        <span class="n">policy</span><span class="o">:</span>
          <span class="n">backoff</span><span class="o">:</span>
            <span class="n">duration</span><span class="o">:</span> <span class="mi">1000000000</span> <span class="err">#</span> <span class="mi">1</span> <span class="n">second</span>
            <span class="n">factor</span><span class="o">:</span> <span class="mi">2</span>
            <span class="n">jitter</span><span class="o">:</span> <span class="mf">0.1</span>
            <span class="n">steps</span><span class="o">:</span> <span class="mi">5</span>
          <span class="n">state</span><span class="o">:</span>
            <span class="n">failure</span><span class="o">:</span>
              <span class="n">workflows</span><span class="o">.</span><span class="na">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">phase</span><span class="o">:</span> <span class="n">Failed</span>
          <span class="n">errorOnBackoffTimeout</span><span class="o">:</span> <span class="kc">false</span>
        <span class="n">group</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span>
        <span class="n">version</span><span class="o">:</span> <span class="n">v1alpha1</span>
        <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
        <span class="n">source</span><span class="o">:</span>
          <span class="n">inline</span><span class="o">:</span> <span class="o">|</span>
            <span class="n">apiVersion</span><span class="o">:</span> <span class="n">argoproj</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
            <span class="n">kind</span><span class="o">:</span> <span class="n">Workflow</span>
            <span class="n">metadata</span><span class="o">:</span>
              <span class="n">generateName</span><span class="o">:</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span>
            <span class="n">spec</span><span class="o">:</span>
              <span class="n">entrypoint</span><span class="o">:</span> <span class="n">whalesay</span>
              <span class="n">templates</span><span class="o">:</span>
              <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">whalesay</span>
                <span class="n">container</span><span class="o">:</span>
                  <span class="n">image</span><span class="o">:</span> <span class="n">docker</span><span class="o">/</span><span class="n">whalesay</span><span class="o">:</span><span class="n">latest</span>
                  <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="n">cowsay</span><span class="o">]</span>
                  <span class="n">args</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;hello world&quot;</span><span class="o">]</span>
</pre></div>


<p>A trigger template can contain execution and backoff policy. Once the trigger is executed by template, it's
state is determined using <code>state</code> labels. If labels defined in <code>success</code> criteria matches the subset of labels defined on the
resource, the execution is treated as successful and vice-versa for labels defined in <code>failure</code> criteria. Please note that you can
only define either success or failure criteria. </p>
<p>The <code>backoff</code> directs the sensor on when to check the labels of the executed trigger resource. If after the backoff retries, the sensor is not able to determine the
state of the resource, <code>errorOnBackoffTimeout</code> controls whether to mark trigger as failure.</p>
<p>The <code>errorOnFailedRound</code> defined outside of triggers decides whether to set the sensor state to <code>error</code> if the previous
round of triggers execution fails. </p>
<h2 id="filters">Filters<a class="headerlink" href="#filters" title="Permanent link">&para;</a></h2>
<p>You can apply following filters on an event dependency. If the event payload passes the filter, then only it will
be treated as a valid event.</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Time</strong></td>
<td>Filters the signal based on time constraints</td>
</tr>
<tr>
<td><strong>EventContext</strong></td>
<td>Filters metadata that provides circumstantial information about the signal.</td>
</tr>
<tr>
<td><strong>Data</strong></td>
<td>Describes constraints and filters for payload</td>
</tr>
</tbody>
</table>
<p><br/></p>
<h3 id="time-filter">Time Filter<a class="headerlink" href="#time-filter" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">filters</span><span class="o">:</span>
        <span class="n">time</span><span class="o">:</span>
          <span class="n">start</span><span class="o">:</span> <span class="s2">&quot;2016-05-10T15:04:05Z07:00&quot;</span>
          <span class="n">stop</span><span class="o">:</span> <span class="s2">&quot;2020-01-02T15:04:05Z07:00&quot;</span>
</pre></div>


<p><a href="https://github.com/argoproj/argo-events/blob/master/examples/sensors/time-filter-webhook.yaml">Example</a></p>
<h3 id="eventcontext-filter">EventContext Filter<a class="headerlink" href="#eventcontext-filter" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">filters</span><span class="o">:</span>
        <span class="n">context</span><span class="o">:</span>
            <span class="n">source</span><span class="o">:</span>
                <span class="n">host</span><span class="o">:</span> <span class="n">amazon</span><span class="o">.</span><span class="na">com</span>
            <span class="n">contentType</span><span class="o">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
</pre></div>


<p><a href="https://github.com/argoproj/argo-events/blob/master/examples/sensors/context-filter-webhook.yaml">Example</a></p>
<h3 id="data-filter">Data filter<a class="headerlink" href="#data-filter" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">filters</span><span class="o">:</span>
        <span class="n">data</span><span class="o">:</span>
            <span class="o">-</span> <span class="n">path</span><span class="o">:</span> <span class="n">bucket</span>
              <span class="n">type</span><span class="o">:</span> <span class="n">string</span>
              <span class="n">value</span><span class="o">:</span> <span class="n">argo</span><span class="o">-</span><span class="n">workflow</span><span class="o">-</span><span class="n">input</span>
</pre></div>


<p><a href="https://github.com/argoproj/argo-events/blob/master/examples/sensors/data-filter-webhook.yaml">Example</a></p>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<p>You can find sensor examples <a href="https://github.com/argoproj/argo-events/tree/master/examples/sensors">here</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../gateway/" title="Gateway" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Gateway
              </span>
            </div>
          </a>
        
        
          <a href="../trigger/" title="Trigger" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Trigger
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>